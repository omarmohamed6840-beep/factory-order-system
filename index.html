<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>MT Factory Orders</title>

<style>
body{font-family:Arial;background:#f4f6f8;direction:rtl;padding:20px}
.box{background:#fff;padding:20px;border-radius:10px;margin-bottom:20px}
input,select,button{width:100%;padding:10px;margin-bottom:10px}
button{background:#0b3c88;color:#fff;border:none}
.order{border-bottom:1px solid #ddd;padding:10px}
.small{color:#666;font-size:14px}
</style>
</head>

<body>

<div class="box">
<h3>إضافة أوردر</h3>

<input id="customer" placeholder="اسم العميل">
<input id="phone" placeholder="رقم الموبايل">
<input id="total" placeholder="إجمالي السعر">
<input id="cost" placeholder="التكلفة">

<button onclick="addOrder()">إضافة</button>
</div>

<div class="box">
<h3>الأوردرات</h3>
<div id="orders"></div>
</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyCvcrAV2T9ocmKJzwBgkDGK18wXxnd3XV0",
  authDomain: "mt-factory.firebaseapp.com",
  projectId: "mt-factory",
};

firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

const ordersDiv = document.getElementById("orders");

async function addOrder(){
  const customer = document.getElementById("customer").value;
  const phone = document.getElementById("phone").value;
  const total = Number(document.getElementById("total").value);
  const cost = Number(document.getElementById("cost").value);

  if(!customer || !total){ alert("كمل البيانات"); return; }

  const snap = await db.collection("orders").get();
  const orderId = "ORD-" + String(snap.size + 1).padStart(4,"0");

  await db.collection("orders").add({
    orderId,
    customer,
    phone,
    total,
    cost,
    profit: total - cost,
    date: new Date()
  });

  document.querySelectorAll("input").forEach(i=>i.value="");
}

db.collection("orders").orderBy("date","desc")
.onSnapshot(snap=>{
  ordersDiv.innerHTML="";
  snap.forEach(doc=>{
    const o = doc.data();
    ordersDiv.innerHTML += `
      <div class="order">
        <b>${o.orderId}</b><br>
        ${o.customer} - ${o.phone}<br>
        إجمالي: ${o.total} | تكلفة: ${o.cost}<br>
        <b>ربح: ${o.profit}</b>
      </div>
    `;
  });
});
</script>

</body>
</html>

