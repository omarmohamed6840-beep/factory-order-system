<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>MT FACTORY â€“ Order System</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{font-family:Arial;direction:rtl;background:#f2f6fb;margin:0;padding:20px;color:#0b3a7e}
h1{text-align:center}
.box{background:#fff;padding:15px;border-radius:10px;margin-bottom:20px;box-shadow:0 2px 6px rgba(0,0,0,.1)}
input,select,button{width:100%;padding:10px;margin-bottom:10px}
button{background:#0b3a7e;color:#fff;border:none;border-radius:6px;cursor:pointer}
.order{border-bottom:1px solid #ddd;padding:10px 0}
.actions button{width:auto;margin-left:5px}
.hidden{display:none}
.report{display:flex;justify-content:space-between}
</style>
</head>

<body>

<!-- LOGIN -->
<div id="loginBox" class="box">
  <h2>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h2>
  <input id="loginPass" type="password" placeholder="Ø§Ù„Ø¨Ø§Ø³ÙˆØ±Ø¯">
  <button onclick="login()">Ø¯Ø®ÙˆÙ„</button>
</div>

<!-- SYSTEM -->
<div id="system" class="hidden">

<h1>MT FACTORY<br>Order System</h1>

<div class="box">
<h3>Ø¥Ø¶Ø§ÙØ© / ØªØ¹Ø¯ÙŠÙ„ Ø£ÙˆØ±Ø¯Ø±</h3>
<input id="customer" placeholder="Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„">
<input id="phone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„">
<input id="total" placeholder="Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø³Ø¹Ø±">
<input id="paid" placeholder="Ø§Ù„Ù…Ø¯ÙÙˆØ¹">
<input id="delivery" type="date">
<select id="status">
  <option>Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°</option>
  <option>ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø¹Ù…ÙŠÙ„</option>
  <option>Ø¬Ø§Ù‡Ø²</option>
  <option>ØªÙ… Ø§Ù„ØªØ³Ù„ÙŠÙ…</option>
</select>
<button onclick="saveOrder()">Ø­ÙØ¸</button>
</div>

<div class="box report">
  <div>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª: <strong id="sumTotal">0</strong></div>
  <div>Ø§Ù„Ù…Ø¯ÙÙˆØ¹: <strong id="sumPaid">0</strong></div>
</div>

<div class="box">
<h3>Ø§Ù„Ø£ÙˆØ±Ø¯Ø±Ø§Øª</h3>
<div id="orders"></div>
</div>

</div>

<script>
const PASSWORD="factory123";
let orders=JSON.parse(localStorage.getItem("factory_orders")||"[]");
let editId=null;

function login(){
 if(loginPass.value===PASSWORD){
  loginBox.classList.add("hidden");
  system.classList.remove("hidden");
  render();
 }else alert("Ø¨Ø§Ø³ÙˆØ±Ø¯ ØºÙ„Ø·");
}

function saveOrder(){
 if(!customer.value||!phone.value||!total.value){alert("ÙƒÙ…Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª");return;}
 if(editId){
  const o=orders.find(x=>x.id===editId);
  Object.assign(o,getData());
  editId=null;
 }else{
  orders.push({...getData(),id:Date.now(),date:new Date().toLocaleDateString()});
 }
 clearForm();
 render();
}

function getData(){
 return{
  customer:customer.value,
  phone:phone.value,
  total:+total.value,
  paid:+paid.value||0,
  status:status.value,
  delivery:delivery.value
 };
}

function clearForm(){
 customer.value=phone.value=total.value=paid.value=delivery.value="";
}

function editOrder(id){
 const o=orders.find(x=>x.id===id);
 Object.assign(customer,o);
 phone.value=o.phone;
 total.value=o.total;
 paid.value=o.paid;
 status.value=o.status;
 delivery.value=o.delivery;
 editId=id;
}

function delOrder(id){
 if(confirm("Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø­Ø°ÙØŸ")){
  orders=orders.filter(o=>o.id!==id);
  render();
 }
}

function invoice(o,lang){
 const t=lang==="en"?
 `Invoice<br>Customer: ${o.customer}`:
 `ÙØ§ØªÙˆØ±Ø©<br>Ø§Ù„Ø¹Ù…ÙŠÙ„: ${o.customer}`;
 const w=window.open("");
 w.document.write(`
 <h2>MT FACTORY</h2>
 <p>${t}</p>
 <p>Ø§Ù„Ù‡Ø§ØªÙ: ${o.phone}</p>
 <p>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${o.total}</p>
 <p>Ø§Ù„Ù…Ø¯ÙÙˆØ¹: ${o.paid}</p>
 <p>Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: ${o.total-o.paid}</p>
 <p>ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ³Ù„ÙŠÙ…: ${o.delivery||"-"}</p>
 <p>ğŸ“ 01044067766</p>
 <script>window.print()</script>
 `);
}

function render(){
 const c=document.getElementById("orders");
 c.innerHTML="";
 let sT=0,sP=0;
 orders.forEach(o=>{
  sT+=o.total;sP+=o.paid;
  c.innerHTML+=`
  <div class="order">
   <strong>${o.customer}</strong> â€“ ${o.phone}<br>
   ${o.total} / ${o.paid} â€“ ${o.status}<br>
   <div class="actions">
    <button onclick="editOrder(${o.id})">âœï¸</button>
    <button onclick="delOrder(${o.id})">ğŸ—‘ï¸</button>
    <button onclick="invoice(${JSON.stringify(o)},'ar')">ğŸ§¾ Ø¹Ø±Ø¨ÙŠ</button>
    <button onclick="invoice(${JSON.stringify(o)},'en')">ğŸ§¾ EN</button>
   </div>
  </div>`;
 });
 sumTotal.innerText=sT;
 sumPaid.innerText=sP;
 localStorage.setItem("factory_orders",JSON.stringify(orders));
}
</script>

</body>
</html>
