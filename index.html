<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>MT FACTORY</title>

<style>
:root{
  --blue:#0b3c88;
  --light:#f4f6f9;
  --card:#ffffff;
  --danger:#c0392b;
  --gray:#7f8c8d;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:Tahoma, Arial;
  background:var(--light);
}
header{
  background:linear-gradient(135deg,#0b3c88,#1e5fd1);
  color:#fff;
  padding:20px;
  text-align:center;
  font-size:24px;
}
.container{
  max-width:1200px;
  margin:auto;
  padding:20px;
}
.card{
  background:var(--card);
  border-radius:14px;
  padding:20px;
  margin-bottom:20px;
  box-shadow:0 8px 18px rgba(0,0,0,.08);
}
h3{margin-top:0;color:var(--blue)}
input{
  width:100%;
  padding:10px;
  margin:6px 0;
  border:1px solid #ddd;
  border-radius:8px;
}
button{
  padding:10px 16px;
  border:none;
  border-radius:8px;
  cursor:pointer;
  font-size:14px;
}
.btn-main{background:var(--blue);color:#fff}
.btn-danger{background:var(--danger);color:#fff}
.btn-gray{background:var(--gray);color:#fff}
.hidden{display:none}

.order{
  border:1px solid #eee;
  border-radius:10px;
  padding:12px;
  margin-bottom:10px;
}
.order-header{
  display:flex;
  justify-content:space-between;
  cursor:pointer;
  font-weight:bold;
}
.details{
  margin-top:10px;
  background:#eef3ff;
  padding:10px;
  border-radius:8px;
}
.totalBox{
  background:linear-gradient(135deg,#0b3c88,#1e5fd1);
  color:#fff;
  padding:20px;
  border-radius:16px;
}
.loginBox{
  max-width:400px;
  margin:120px auto;
}
.grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:20px;
}
@media(max-width:900px){
  .grid{grid-template-columns:1fr}
}
</style>
</head>

<body>

<header>MT FACTORY</header>

<div class="card loginBox" id="loginBox">
  <h3>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h3>
  <input type="password" id="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
  <button class="btn-main" onclick="login()">Ø¯Ø®ÙˆÙ„</button>
</div>

<div class="container hidden" id="app">

<div class="grid">
<div class="card">
  <h3>Ø¥Ø¶Ø§ÙØ© / ØªØ¹Ø¯ÙŠÙ„ Ø£ÙˆØ±Ø¯Ø±</h3>
  <input id="customer" placeholder="Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„">
  <input id="phone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„">
  <input id="product" placeholder="Ø§Ù„Ù…Ù†ØªØ¬">
  <input id="price" type="number" placeholder="Ø³Ø¹Ø± Ø§Ù„Ù…Ù†ØªØ¬">
  <input id="shipping" type="number" placeholder="Ø§Ù„Ø´Ø­Ù†">
  <input id="install" type="number" placeholder="Ø®Ø¯Ù…Ø© Ø§Ù„ØªØ±ÙƒÙŠØ¨">
  <input id="discount" type="number" placeholder="Ø®ØµÙ…">
  <button class="btn-main" onclick="saveOrder()">Ø­ÙØ¸ Ø§Ù„Ø£ÙˆØ±Ø¯Ø±</button>
</div>

<div class="card">
  <h3>Ø¨Ø­Ø« Ø¨Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„</h3>
  <input id="search" placeholder="Ø§ÙƒØªØ¨ Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„" oninput="renderOrders()">
</div>
</div>

<div class="card">
  <h3>Ø§Ù„Ø£ÙˆØ±Ø¯Ø±Ø§Øª</h3>
  <div id="orders"></div>
</div>

<div class="totalBox">
  Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª: <b><span id="totalSales">0</span></b>
</div>

</div>

<script>
const PASSWORD="factory123";

const loginBox=document.getElementById("loginBox");
const app=document.getElementById("app");
const password=document.getElementById("password");
const ordersDiv=document.getElementById("orders");
const search=document.getElementById("search");

const customer=document.getElementById("customer");
const phone=document.getElementById("phone");
const product=document.getElementById("product");
const price=document.getElementById("price");
const shipping=document.getElementById("shipping");
const install=document.getElementById("install");
const discount=document.getElementById("discount");
const totalSales=document.getElementById("totalSales");

let orders=JSON.parse(localStorage.getItem("orders")||"[]");
let editIndex=null;

function login(){
  if(password.value===PASSWORD){
    loginBox.classList.add("hidden");
    app.classList.remove("hidden");
    renderOrders();
  } else alert("ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø®Ø·Ø£");
}

function generateId(){
  return "ORD-"+Date.now();
}

function saveOrder(){
  const total=
    (+price.value||0)+
    (+shipping.value||0)+
    (+install.value||0)-
    (+discount.value||0);

  const data={
    id:editIndex===null?generateId():orders[editIndex].id,
    customer:customer.value,
    phone:phone.value,
    product:product.value,
    price:+price.value||0,
    shipping:+shipping.value||0,
    install:+install.value||0,
    discount:+discount.value||0,
    total
  };

  if(editIndex===null) orders.push(data);
  else orders[editIndex]=data,editIndex=null;

  localStorage.setItem("orders",JSON.stringify(orders));
  clearForm();renderOrders();
}

function clearForm(){
  customer.value=phone.value=product.value=
  price.value=shipping.value=install.value=discount.value="";
}

function renderOrders(){
  ordersDiv.innerHTML="";
  let sum=0;
  const q=search.value.trim();

  orders.filter(o=>o.phone.includes(q)).forEach((o,i)=>{
    sum+=o.total;
    ordersDiv.innerHTML+=`
    <div class="order">
      <div class="order-header" onclick="toggle(${i})">
        <span>${o.customer} - ${o.total}</span>
        <span>${o.id}</span>
      </div>
      <div class="details hidden" id="d${i}">
        <p>ğŸ“¦ Ø§Ù„Ù…Ù†ØªØ¬: ${o.product}</p>
        <p>ğŸ’° Ø§Ù„Ø³Ø¹Ø±: ${o.price}</p>
        <p>ğŸšš Ø§Ù„Ø´Ø­Ù†: ${o.shipping}</p>
        <p>ğŸ›  Ø§Ù„ØªØ±ÙƒÙŠØ¨: ${o.install}</p>
        <p>â– Ø§Ù„Ø®ØµÙ…: ${o.discount}</p>
        <p><b>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${o.total}</b></p>
        <button class="btn-gray" onclick="edit(${i});event.stopPropagation()">ØªØ¹Ø¯ÙŠÙ„</button>
        <button class="btn-danger" onclick="del(${i});event.stopPropagation()">Ø­Ø°Ù</button>
        <button class="btn-main" onclick="invoice(${i});event.stopPropagation()">ÙØ§ØªÙˆØ±Ø©</button>
      </div>
    </div>`;
  });

  totalSales.innerText=sum;
}

function toggle(i){document.getElementById("d"+i).classList.toggle("hidden")}
function edit(i){
  const o=orders[i];editIndex=i;
  customer.value=o.customer;
  phone.value=o.phone;
  product.value=o.product;
  price.value=o.price;
  shipping.value=o.shipping;
  install.value=o.install;
  discount.value=o.discount;
}
function del(i){
  if(confirm("Ø­Ø°ÙØŸ")){
    orders.splice(i,1);
    localStorage.setItem("orders",JSON.stringify(orders));
    renderOrders();
  }
}
function invoice(i){
  const o=orders[i];
  const w=window.open("");
  w.document.write(`
    <h2>MT FACTORY</h2>
    <p>Order ID: ${o.id}</p>
    <p>Client: ${o.customer}</p>
    <hr>
    <p>Product: ${o.product}</p>
    <p>Total: ${o.total}</p>
    <script>window.print()</script>
  `);
}
</script>

</body>
</html>
