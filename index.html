<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>MT FACTORY - Ù†Ø¸Ø§Ù… Ø§Ù„Ø£ÙˆØ±Ø¯Ø±Ø§Øª</title>
<style>
:root{
  --blue:#0b3c88;
  --blue-light:#eaf0ff;
  --gray:#f4f6f9;
  --danger:#c0392b;
  --success:#27ae60;
}
*{box-sizing:border-box}
body{
  font-family:Tahoma, Arial;
  background:var(--gray);
  margin:0;
  color:#333;
}
header{
  background:var(--blue);
  color:#fff;
  padding:18px;
  text-align:center;
  font-size:22px;
  box-shadow:0 2px 6px rgba(0,0,0,.15);
}
.container{
  max-width:1100px;
  margin:auto;
  padding:20px;
}
.card{
  background:#fff;
  border-radius:12px;
  padding:20px;
  margin-bottom:20px;
  box-shadow:0 4px 12px rgba(0,0,0,.06);
}
.card h3{
  margin-top:0;
  color:var(--blue);
}
input,textarea{
  width:100%;
  padding:10px 12px;
  margin:6px 0;
  border:1px solid #ddd;
  border-radius:8px;
  font-size:14px;
}
input:focus,textarea:focus{
  outline:none;
  border-color:var(--blue);
}
.btn{
  padding:10px 14px;
  border:none;
  border-radius:8px;
  cursor:pointer;
  font-size:14px;
}
.btn-primary{background:var(--blue);color:#fff}
.btn-danger{background:var(--danger);color:#fff}
.btn-secondary{background:#bdc3c7;color:#2c3e50}
.btn + .btn{margin-right:6px}
.hidden{display:none}

.order{
  border:1px solid #e6e6e6;
  border-radius:10px;
  padding:12px;
  margin-bottom:10px;
  transition:.2s;
}
.order:hover{background:#fafcff}
.order-header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  cursor:pointer;
}
.order-id{
  font-weight:bold;
  color:var(--blue);
}
.details{
  background:var(--blue-light);
  border-radius:8px;
  padding:10px;
  margin-top:10px;
}
.actions{
  margin-top:10px;
}
.totalBox{
  background:linear-gradient(135deg,var(--blue),#1f5fd1);
  color:#fff;
  border-radius:14px;
  padding:20px;
}
.totalBox p{
  margin:6px 0;
  font-size:16px;
}
.totalBox b{font-size:20px}
.login-card{
  max-width:400px;
  margin:120px auto;
}
.section-grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:20px;
}
@media(max-width:800px){
  .section-grid{grid-template-columns:1fr}
}
</style>
</head>

<body>

<header>MT FACTORY</header>

<!-- LOGIN -->
<div id="loginBox" class="card login-card">
  <h3>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h3>
  <input type="password" id="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
  <button class="btn btn-primary" onclick="login()">Ø¯Ø®ÙˆÙ„</button>
</div>

<!-- APP -->
<div id="app" class="hidden container">

<div class="section-grid">

  <div class="card">
    <h3>Ø¥Ø¶Ø§ÙØ© / ØªØ¹Ø¯ÙŠÙ„ Ø£ÙˆØ±Ø¯Ø±</h3>
    <input id="customer" placeholder="Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„">
    <input id="phone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„">
    <input id="address" placeholder="Ø§Ù„Ø¹Ù†ÙˆØ§Ù†">
    <input id="product" placeholder="Ø§Ù„Ù…Ù†ØªØ¬">
    <input id="price" type="number" placeholder="Ø§Ù„Ø³Ø¹Ø±">
    <button class="btn btn-primary" onclick="saveOrder()">Ø­ÙØ¸ Ø§Ù„Ø£ÙˆØ±Ø¯Ø±</button>
  </div>

  <div class="card">
    <h3>Cash Out (Ù…ØµØ±ÙˆÙØ§Øª)</h3>
    <input id="expenseNote" placeholder="Ø§ØªØµØ±ÙØª ÙÙŠ Ø¥ÙŠÙ‡ØŸ">
    <input id="expenseAmount" type="number" placeholder="Ø§Ù„Ù…Ø¨Ù„Øº">
    <button class="btn btn-secondary" onclick="addExpense()">Ø¥Ø¶Ø§ÙØ© Ù…ØµØ±ÙˆÙ</button>
    <div id="expenses"></div>
  </div>

</div>

<div class="card">
  <h3>Ø¨Ø­Ø« Ø¨Ø±Ù‚Ù… Ø§Ù„Ø£ÙˆØ±Ø¯Ø±</h3>
  <input id="search" placeholder="ORD-0001" oninput="renderOrders()">
</div>

<div class="card">
  <h3>Ø§Ù„Ø£ÙˆØ±Ø¯Ø±Ø§Øª</h3>
  <div id="orders"></div>
</div>

<div class="totalBox">
  <p>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£ÙˆØ±Ø¯Ø±Ø§Øª</p>
  <b><span id="totalSales">0</span></b>
  <p>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª</p>
  <b><span id="totalExpenses">0</span></b>
  <p>Ø§Ù„ØµØ§ÙÙŠ</p>
  <b><span id="netTotal">0</span></b>
</div>

</div>

<script>
const PASSWORD="factory123";
let orders=JSON.parse(localStorage.getItem("orders")||"[]");
let expenses=JSON.parse(localStorage.getItem("expenses")||"[]");
let editOrderIndex=null;

const ordersDiv=document.getElementById("orders");
const expensesDiv=document.getElementById("expenses");

function login(){
  if(password.value===PASSWORD){
    loginBox.classList.add("hidden");
    app.classList.remove("hidden");
    renderOrders(); renderExpenses();
  } else alert("ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø®Ø·Ø£");
}

function generateId(){
  return "ORD-"+String(orders.length+1).padStart(4,"0");
}

function saveOrder(){
  if(!customer.value||!price.value) return alert("Ø£ÙƒÙ…Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª");

  if(editOrderIndex===null){
    orders.push({
      id:generateId(),
      customer:customer.value,
      phone:phone.value,
      address:address.value,
      product:product.value,
      price:Number(price.value)
    });
  } else {
    Object.assign(orders[editOrderIndex],{
      customer:customer.value,
      phone:phone.value,
      address:address.value,
      product:product.value,
      price:Number(price.value)
    });
    editOrderIndex=null;
  }
  localStorage.setItem("orders",JSON.stringify(orders));
  customer.value=phone.value=address.value=product.value=price.value="";
  renderOrders();
}

function renderOrders(){
  ordersDiv.innerHTML="";
  let sales=0;
  const q=search.value.toLowerCase();

  orders.filter(o=>o.id.toLowerCase().includes(q)).forEach((o,i)=>{
    sales+=o.price;
    ordersDiv.innerHTML+=`
      <div class="order">
        <div class="order-header" onclick="toggleDetails(${i})">
          <span class="order-id">${o.id}</span>
          <span>${o.customer} â€” ${o.price}</span>
        </div>
        <div class="details hidden" id="details-${i}">
          <p>ğŸ“ ${o.phone}</p>
          <p>ğŸ“ ${o.address}</p>
          <p>ğŸ“¦ ${o.product}</p>
          <div class="actions">
            <button class="btn btn-secondary" onclick="editOrder(${i});event.stopPropagation()">ØªØ¹Ø¯ÙŠÙ„</button>
            <button class="btn btn-danger" onclick="deleteOrder(${i});event.stopPropagation()">Ø­Ø°Ù</button>
          </div>
        </div>
      </div>`;
  });

  totalSales.innerText=sales;
  calculateNet();
}

function toggleDetails(i){
  document.getElementById("details-"+i).classList.toggle("hidden");
}

function editOrder(i){
  const o=orders[i];
  customer.value=o.customer;
  phone.value=o.phone;
  address.value=o.address;
  product.value=o.product;
  price.value=o.price;
  editOrderIndex=i;
}

function deleteOrder(i){
  if(confirm("Ø­Ø°Ù Ø§Ù„Ø£ÙˆØ±Ø¯Ø±ØŸ")){
    orders.splice(i,1);
    localStorage.setItem("orders",JSON.stringify(orders));
    renderOrders();
  }
}

function addExpense(){
  if(!expenseNote.value||!expenseAmount.value) return;
  expenses.push({note:expenseNote.value,amount:Number(expenseAmount.value)});
  localStorage.setItem("expenses",JSON.stringify(expenses));
  expenseNote.value=expenseAmount.value="";
  renderExpenses();
}

function renderExpenses(){
  expensesDiv.innerHTML="";
  let expTotal=0;
  expenses.forEach((e,i)=>{
    expTotal+=e.amount;
    expensesDiv.innerHTML+=`
      <div class="order">
        ${e.note} â€” ${e.amount}
        <button class="btn btn-danger" onclick="deleteExpense(${i})">Ø­Ø°Ù</button>
      </div>`;
  });
  totalExpenses.innerText=expTotal;
  calculateNet();
}

function deleteExpense(i){
  expenses.splice(i,1);
  localStorage.setItem("expenses",JSON.stringify(expenses));
  renderExpenses();
}

function calculateNet(){
  netTotal.innerText=
    Number(totalSales.innerText)-Number(totalExpenses.innerText);
}
</script>

</body>
</html>
