<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>MT FACTORY</title>

<style>
body{
  margin:0;
  font-family:Tahoma,Arial;
  background:#f4f6f9;
}
header{
  background:linear-gradient(135deg,#0b3c88,#1e5fd1);
  color:#fff;
  padding:20px;
  text-align:center;
  font-size:24px;
}
.container{
  max-width:1100px;
  margin:auto;
  padding:20px;
}
.card{
  background:#fff;
  border-radius:14px;
  padding:20px;
  margin-bottom:20px;
  box-shadow:0 8px 18px rgba(0,0,0,.08);
}
input{
  width:100%;
  padding:10px;
  margin:6px 0;
  border:1px solid #ddd;
  border-radius:8px;
}
button{
  padding:10px 16px;
  border:none;
  border-radius:8px;
  cursor:pointer;
}
.main{background:#0b3c88;color:#fff}
.danger{background:#c0392b;color:#fff}
.gray{background:#7f8c8d;color:#fff}
.hidden{display:none}
.order{
  border:1px solid #eee;
  border-radius:10px;
  padding:12px;
  margin-bottom:10px;
}
.orderHeader{
  display:flex;
  justify-content:space-between;
  cursor:pointer;
  font-weight:bold;
}
.details{
  margin-top:10px;
  background:#eef3ff;
  padding:10px;
  border-radius:8px;
}
.totalBox{
  background:#0b3c88;
  color:#fff;
  padding:20px;
  border-radius:14px;
}
.loginBox{
  max-width:400px;
  margin:120px auto;
}
</style>
</head>

<body>

<header>MT FACTORY</header>

<div class="card loginBox" id="loginBox">
  <h3>تسجيل الدخول</h3>
  <input type="password" id="password" placeholder="كلمة المرور">
  <button class="main" onclick="login()">دخول</button>
</div>

<div class="container hidden" id="app">

<div class="card">
  <h3>إضافة أوردر</h3>
  <input id="customer" placeholder="اسم العميل">
  <input id="phone" placeholder="رقم الموبايل">
  <input id="product" placeholder="المنتج">
  <input id="price" type="number" placeholder="سعر المنتج">
  <input id="shipping" type="number" placeholder="الشحن">
  <input id="install" type="number" placeholder="التركيب">
  <input id="discount" type="number" placeholder="خصم">
  <button class="main" onclick="saveOrder()">حفظ الأوردر</button>
</div>

<div class="card">
  <h3>بحث برقم الموبايل</h3>
  <input id="search" placeholder="اكتب رقم الموبايل" oninput="renderOrders()">
</div>

<div class="card">
  <h3>الأوردرات</h3>
  <div id="orders"></div>
</div>

<div class="totalBox">
  إجمالي المبيعات: <b><span id="totalSales">0</span></b>
</div>

</div>

<script>
const PASSWORD="factory123";

const loginBox=document.getElementById("loginBox");
const app=document.getElementById("app");
const password=document.getElementById("password");
const ordersDiv=document.getElementById("orders");
const search=document.getElementById("search");
const totalSales=document.getElementById("totalSales");

const customer=document.getElementById("customer");
const phone=document.getElementById("phone");
const product=document.getElementById("product");
const price=document.getElementById("price");
const shipping=document.getElementById("shipping");
const install=document.getElementById("install");
const discount=document.getElementById("discount");

let orders=JSON.parse(localStorage.getItem("orders")||"[]");
let editIndex=null;

function login(){
  if(password.value===PASSWORD){
    loginBox.classList.add("hidden");
    app.classList.remove("hidden");
    renderOrders();
  }else alert("كلمة المرور خطأ");
}

function saveOrder(){
  const total=
    (+price.value||0)+
    (+shipping.value||0)+
    (+install.value||0)-
    (+discount.value||0);

  const data={
    id:"ORD-"+Date.now(),
    customer:customer.value,
    phone:phone.value,
    product:product.value,
    price:+price.value||0,
    shipping:+shipping.value||0,
    install:+install.value||0,
    discount:+discount.value||0,
    total
  };

  orders.push(data);
  localStorage.setItem("orders",JSON.stringify(orders));
  clearForm();
  renderOrders();
}

function clearForm(){
  customer.value="";
  phone.value="";
  product.value="";
  price.value="";
  shipping.value="";
  install.value="";
  discount.value="";
}

function renderOrders(){
  ordersDiv.innerHTML="";
  let sum=0;
  const q=search.value||"";

  orders.filter(o=>o.phone.includes(q)).forEach((o,i)=>{
    sum+=o.total;
    ordersDiv.innerHTML+=
      '<div class="order">'+
      '<div class="orderHeader" onclick="toggle('+i+')">'+
      '<span>'+o.customer+' - '+o.total+'</span>'+
      '<span>'+o.id+'</span>'+
      '</div>'+
      '<div class="details hidden" id="d'+i+'">'+
      '<p>المنتج: '+o.product+'</p>'+
      '<p>الإجمالي: '+o.total+'</p>'+
      '<button class="danger" onclick="del('+i+')">حذف</button>'+
      '</div></div>';
  });

  totalSales.innerText=sum;
}

function toggle(i){
  document.getElementById("d"+i).classList.toggle("hidden");
}

function del(i){
  if(confirm("حذف الأوردر؟")){
    orders.splice(i,1);
    localStorage.setItem("orders",JSON.stringify(orders));
    renderOrders();
  }
}
</script>

</body>
</html>
